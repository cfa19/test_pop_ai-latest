services:
  - type: web
    name: pop-skills-api
    runtime: docker
    plan: free
    dockerfilePath: ./Dockerfile
    healthCheckPath: /docs
    envVars:
      # Supabase
      - key: SUPABASE_URL
        sync: false
      - key: SUPABASE_SERVICE_ROLE_KEY
        sync: false

      # OpenAI
      - key: OPENAI_API_KEY
        sync: false

      # Voyage AI (Embeddings)
      - key: VOYAGE_API_KEY
        sync: false
      - key: EMBED_MODEL
        value: voyage-3-large
      - key: EMBED_DIMENSIONS
        value: "1024"

      # Chat
      - key: CHAT_MODEL
        value: gpt-4o-mini
      - key: CHAT_PROVIDER
        value: openai
      - key: EMBED_PROVIDER
        value: voyage

      # Intent Classifier (ONNX from HuggingFace Hub)
      - key: PRIMARY_INTENT_CLASSIFIER_TYPE
        value: onnx
      - key: HF_REPO_ID
        value: cfa0819/pop-skills-onnx

      # Semantic Gate (ONNX-based, no PyTorch required)
      - key: SEMANTIC_GATE_ENABLED
        value: "true"

      # JWT
      - key: JWT_ALGORITHM
        value: ES256
